<html>
    <link rel="stylesheet" href="{{ url_for('static', filename='navbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='controls.css') }}">
    <link href="https://fonts.cdnfonts.com/css/old-english-five" rel="stylesheet">
</html>

<nav>
    <div class="hamburger-menu">
        <input type="checkbox" id="menu-toggle">
        <label for="menu-toggle" class="menu-icon">
            <span></span>
            <span></span>
            <span></span>
        </label>
        <div class="menu">
            <ul>
                <li><a href="/">Home</a></li>
                <hr>
                <li>
                    <label for="fontSelect">Font:</label>
                    <select id="fontSelect">
                        <option value="Georgia">Georgia</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Arial">Arial</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Old English Five">Old English Five</option>
                    </select>
                </li>
                <li>
                    <label for="fontSize">Font Size:</label>
                    <input type="range" id="fontSize" min="12" max="48" value="16">
                </li>
                <hr>
                <li><a href="/general-prologue">General Prologue</a></li>
                <li><a href="/knights-tale">Knight's Tale</a></li>
            </ul>
        </div>
    </div>

    <h2 id="logo">
        <span id="easy">Easy</span><span id="chaucer">Chaucer</span>
    </h2>
    
    <button id="darkModeToggle" class="dark-mode-toggle">
        <img src="{{ url_for('static', filename='assets/light.png') }}" alt="Light Mode" class="light-icon">
        <img src="{{ url_for('static', filename='assets/dark.png') }}" alt="Dark Mode" class="dark-icon">
    </button>
</nav>

<script>
    const darkModeToggle = document.getElementById('darkModeToggle');
    const body = document.body;
    const fontSizeSlider = document.getElementById('fontSize');
    const fontSelect = document.getElementById('fontSelect');
    
    fontSizeSlider.addEventListener('input', updateStyle);
    fontSelect.addEventListener('change', updateStyle);
    
    document.addEventListener("DOMContentLoaded", function() {
        const container = document.querySelector('.container');
        
        if (localStorage.getItem('darkMode') === 'true') {
            body.classList.add('dark-mode');
        }
        if (localStorage.getItem('fontSize')) {
        const fontSize = localStorage.getItem('fontSize');
        
        container.style.fontSize = fontSize + 'px';
        fontSizeSlider.value = fontSize;
        }
        if (localStorage.getItem('fontFamily')) {
            const fontFamily = localStorage.getItem('fontFamily');

            container.style.fontFamily = fontFamily;
            fontSelect.value = fontFamily;
        }
    })

    // Toggle dark mode
    darkModeToggle.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        localStorage.setItem('darkMode', body.classList.contains('dark-mode'));
        
        // Toggle visibility of icons
        const lightIcon = darkModeToggle.querySelector('.light-icon');
        const darkIcon = darkModeToggle.querySelector('.dark-icon');
        
        if (body.classList.contains('dark-mode')) {
            lightIcon.style.display = 'none';
            darkIcon.style.display = 'inline-block';
        } else {
            darkIcon.style.display = 'none';
            lightIcon.style.display = 'inline-block';
        }
    });

    function updateStyle() {
        const container = document.querySelector('.container');

        const fontSize = fontSizeSlider.value;
        const fontFamily = fontSelect.value;

        container.style.fontSize = fontSize + 'px';
        container.style.fontFamily = fontFamily;

        localStorage.setItem('fontSize', fontSize);
        localStorage.setItem('fontFamily', fontFamily);
    }
</script>